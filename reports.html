<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://kit-pro.fontawesome.com/releases/v6.1.1/css/pro.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="images/kr_logo.png">
    <title>Zgłoszenia</title>
</head>

<body>
    <div class="app">
        <nav>
            <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                <div class="logo">
                    <a href="index.html"><span class="mypage-title">KR Name</span></a>
                </div>
                <div class="menu-toggle-btn" id="menu-nav-btn">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>

            <ul class="navbar-menu"></ul>
        </nav>
        <div class="view">
            <div class="reporst-container">
                <div style="display: flex; flex-direction: column; gap: 2vh;">
                    <div class="reports-title">Wyślij Zgłoszenie</div>
                    <div class="reports-description">Tu możesz wysłać zgłoszenia, błędy oraz propozycje</div>
                </div>
                <textarea name="" id="report-content"></textarea>
                <div class="report-button" onclick="sendMessage()">Wyślij zgłoszenie</div>
            </div>
        </div>
        <footer class="footer">
            <div class="footer-title">Strona tworzona przez Krupeczekk</div>
            <div class="footer-description"><span class="mypage-title">KR Name</span> | Wszelkie prawa zastrzeżone ©
                <span class="mypage-year">2025</span></div>
        </footer>
    </div>

    <div class="calculator-calculator"></div>
</body>
<script src="app.js"></script>
<script src="config.js"></script>
<script>
    async function sendMessage() {
        const msg = document.getElementById('report-content').value;

        if (!msg.trim()) return
        const now = new Date()
        const formatedDate = now.toLocaleDateString('pl-PL')
        const formatedTime = now.toLocaleTimeString('pl-PL')
        const messageToSend = `
        **Zgłoszenie | KR SpedTools & Logistics | ${formatedDate} - ${formatedTime}**

**Treść zgłoszenia**
*${msg}*`
        const res = await fetch('http://localhost:3000/send-message', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ message: messageToSend })
        })

        if (res.ok) {
            document.getElementById('report-content').value = ''
            alert('Wysłano zgłoszenie')
        } else {
            alert('Wystąpił błąd podczas wysyłania zgłoszenia...')
        }
    }
</script>

</html>